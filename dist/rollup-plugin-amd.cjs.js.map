{"version":3,"file":"rollup-plugin-amd.cjs.js","sources":["../src/index.js"],"sourcesContent":["import convert from '@buxlabs/amd-to-es6';\r\nimport { createFilter } from 'rollup-pluginutils';\r\nimport os from 'os';\r\n\r\nconst isWindows = os.platform === 'win32';\r\n\r\nconst firstpass = /\\b(?:define)\\b/;\r\nconst importStatement = /\\b(import .*['\"])(.*)(['\"].*\\n)/g;\r\n\r\nexport default function(options = {}) {\r\n    const filter = createFilter( options.include, options.exclude );\r\n\r\n    return {\r\n        name: 'amd',\r\n\r\n        transform (code, id) {\r\n            if ( !filter( id ) ) return;\r\n            if ( !firstpass.test( code ) ) return;\r\n\r\n            let transformed = convert(code, options.converter);\r\n            if (options.rewire) {\r\n                transformed = transformed.replace(importStatement, (match, begin, moduleId, end) => {\r\n                    const rewire = isWindows ? options.rewire(moduleId, id).split('\\\\').join('\\\\\\\\') : options.rewire(moduleId, id);\r\n                    return `${begin}${rewire || moduleId}${end}`;\r\n                });\r\n            }\r\n\r\n            return transformed;\r\n        }\r\n    };\r\n}\r\n"],"names":["const","createFilter","let"],"mappings":";;;;;;;;AAIAA,IAAM,SAAS,GAAG,EAAE,CAAC,QAAQ,KAAK,OAAO,CAAC;AAC1C;AACAA,IAAM,SAAS,GAAG,gBAAgB,CAAC;AACnCA,IAAM,eAAe,GAAG,kCAAkC,CAAC;AAC3D;AACe,eAAS,OAAY,EAAE;qCAAP,GAAG;AAAK;AACvC,IAAIA,IAAM,MAAM,GAAGC,8BAAY,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,EAAE,CAAC;AACpE;AACA,IAAI,OAAO;AACX,QAAQ,IAAI,EAAE,KAAK;AACnB;AACA,QAAQ,6BAAS,EAAE,IAAI,EAAE,EAAE,EAAE;AAC7B,YAAY,KAAK,CAAC,MAAM,EAAE,EAAE,EAAE,KAAG,SAAO;AACxC,YAAY,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,KAAG,SAAO;AAClD;AACA,YAAYC,IAAI,WAAW,GAAG,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;AAC/D,YAAY,IAAI,OAAO,CAAC,MAAM,EAAE;AAChC,gBAAgB,WAAW,GAAG,WAAW,CAAC,OAAO,CAAC,eAAe,YAAG,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAK;AACpG,oBAAoBF,IAAM,MAAM,GAAG,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;AACpI,oBAAoB,aAAU,SAAQ,MAAM,IAAI,YAAW,KAAM;AACjE,iBAAiB,CAAC,CAAC;AACnB,aAAa;AACb;AACA,YAAY,OAAO,WAAW,CAAC;AAC/B,SAAS;AACT,KAAK,CAAC;AACN;;;;"}